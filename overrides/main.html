<!-- Elements added to main will be displayed on all pages -->
{% extends "base.html" %}

<!-- Outdated bar -->
{% block outdated %} You're not viewing the latest version.
<a href="#" id="go-to-latest">
  <strong>Click here to go to latest.</strong>
</a>

<script>
  document
    .getElementById("go-to-latest")
    .addEventListener("click", function (event) {
      event.preventDefault();

      fetch("/versions.json")
        .then((response) => response.json())
        .then((data) => {
          if (!Array.isArray(data)) {
            console.error("Invalid versions.json format");
            return;
          }

          // Find the version with alias 'latest'
          const latestEntry = data.find(
            (v) => Array.isArray(v.aliases) && v.aliases.includes("latest")
          );
          const latestVersion = latestEntry?.version;

          if (!latestVersion) {
            console.error("Latest version not found in versions.json");
            return;
          }

          const currentPath = window.location.pathname;
          const versionPattern = /^\/([\d.]+)(\/.*)?$/;
          const match = currentPath.match(versionPattern);

          const pathWithoutVersion = match ? match[2] || "/" : currentPath;
          const newUrl = "/" + latestVersion + pathWithoutVersion;
          window.location.href = newUrl;
        })
        .catch((err) => console.error("Failed to fetch versions.json", err));
    });
</script>
{% endblock %}

<!-- Announcement bar -->
{% block announce %}

<style>
  .md-announce a:hover {
    color: currentColor;
  }
  .md-announce strong {
    white-space: nowrap;
  }
</style>

<strong>
  <a href="/latest/contributing/need-help"
    >We need help! If you have experience in C# or Python we would love to have
    you help out. Click here for more.</a
  >
</strong>

{% endblock %}
